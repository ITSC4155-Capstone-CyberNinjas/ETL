/* COMMANDS FOR COMMAND PROMPT
1) Open SnowSQL with: snowsql -a tub49591.us-east-1 -u <USERNAME>
2) Input your password
3) Upload CSV files using: put file://<FILE PATH> @MY_STAGE OVERWRITE = TRUE;
IN HERE:
4) To check files, use: ls @MY_STAGE;
5) To remove files, use: rm @MY_STAGE/<FILE NAME>;
*/

CREATE DATABASE IF NOT EXISTS 'NINER_TRANSIT';
USE 'NINER_TRANSIT';

/*'Wifi_Counts' table*/
CREATE OR REPLACE TABLE PUBLIC."Wifi_Counts" (
	"timestamp" DATETIME,
	"Atki" INT,
	"Auxi" INT,
	"BaTF" INT,
	"Band" INT,
	"Barn" INT,
	"BelG" INT,
	"BelH" INT,
	"Bioi" INT,
	"Burs" INT,
	"Cafe" INT,
	"Came" INT,
	"Cato" INT,
	"Ceda" INT,
	"CoEd" INT,
	"Colv" INT,
	"Cone" INT,
	"Coun" INT,
	"Denn" INT,
	"Duke" INT,
	"EPIC" INT,
	"FOPS" INT,
	"Faci" INT,
	"Foun" INT,
	"Fret" INT,
	"Frid" INT,
	"Gage" INT,
	"Gari" INT,
	"Grig" INT,
	"Harr" INT,
	"Heal" INT,
	"Hick" INT,
	"Hous" INT,
	"HunH" INT,
	"Irwi" INT,
	"JBui" INT,
	"Kenn" INT,
	"King" INT,
	"Laur" INT,
	"Levi" INT,
	"Lync" INT,
	"MSII" INT,
	"Macy" INT,
	"Mart" INT,
	"McCo" INT,
	"McMi" INT,
	"Memo" INT,
	"MilH" INT,
	"Milt" INT,
	"NERF" INT,
	"PORT" INT,
	"Phil" INT,
	"Pros" INT,
	"Rece" INT,
	"Rees" INT,
	"Robi" INT,
	"Rowe" INT,
	"SVDH" INT,
	"Scot" INT,
	"Smit" INT,
	"SoTF" INT,
	"Stor" INT,
	"StuA" INT,
	"StuH" INT,
	"StuU" INT,
	"Syca" INT,
	"Tenn" INT,
	"UREC" INT,
	"Unio" INT,
	"Wach" INT,
	"Wall" INT,
	"Winn" INT,
	"With" INT,
	"Wood" INT
);

/* RUN THIS LINE */
SELECT * FROM "Wifi_Counts";

ls @MY_STAGE;

/* Copies from CSV*/  
copy into PUBLIC."Wifi_Counts" (
	"timestamp",
	"Atki",
	"Auxi",
	"BaTF",
	"Band",
	"Barn",
	"BelG",
	"BelH",
	"Bioi",
	"Burs",
	"Cafe",
	"Came",
	"Cato",
	"Ceda",
	"CoEd",
	"Colv",
	"Cone",
	"Coun",
	"Denn",
	"Duke",
	"EPIC",
	"FOPS",
	"Faci",
	"Foun",
	"Fret",
	"Frid",
	"Gage",
	"Gari",
	"Grig",
	"Harr",
	"Heal",
	"Hick",
	"Hous",
	"HunH",
	"Irwi",
	"JBui",
	"Kenn",
	"King",
	"Laur",
	"Levi",
	"Lync",
	"MSII",
	"Macy",
	"Mart",
	"McCo",
	"McMi",
	"Memo",
	"MilH",
	"Milt",
	"NERF",
	"PORT",
	"Phil",
	"Pros",
	"Rece",
	"Rees",
	"Robi",
	"Rowe",
	"SVDH",
	"Scot",
	"Smit",
	"SoTF",
	"Stor",
	"StuA",
	"StuH",
	"StuU",
	"Syca",
	"Tenn",
	"UREC",
	"Unio",
	"Wach",
	"Wall",
	"Winn",
	"With",
	"Wood"
)

from (
select
	c.$1,
	c.$2,
	c.$3,
	c.$4,
	c.$5,
	c.$6,
	c.$7,
	c.$8,
	c.$9,
	c.$10,
	c.$11,
	c.$12,
	c.$13,
	c.$14,
	c.$15,
	c.$16,
	c.$17,
	c.$18,
	c.$19,
	c.$20,
	c.$21,
	c.$22,
	c.$23,
	c.$24,
	c.$25,
	c.$26,
	c.$27,
	c.$28,
	c.$29,
	c.$30,
	c.$31,
	c.$32,
	c.$33,
	c.$34,
	c.$35,
	c.$36,
	c.$37,
	c.$38,
	c.$39,
	c.$40,
	c.$41,
	c.$42,
	c.$43,
	c.$44,
	c.$45,
	c.$46,
	c.$47,
	c.$48,
	c.$49,
	c.$50,
	c.$51,
	c.$52,
	c.$53,
	c.$54,
	c.$55,
	c.$56,
	c.$57,
	c.$58,
	c.$59,
	c.$60,
	c.$61,
	c.$62,
	c.$63,
	c.$64,
	c.$65,
	c.$66,
	c.$67,
	c.$68,
	c.$69,
	c.$70,
	c.$71,
	c.$72,
	c.$73,
	c.$74
from @NINER_TRANSIT.PUBLIC.MY_STAGE/wifi_counts_combined.csv.gz(file_format => CSV_FORMAT) c
);